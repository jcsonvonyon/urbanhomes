import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css                  */import{u as m,c as f,d as p,a as u}from"./auth-Wv6XBAm1.js";let d=null;async function w(){const{user:t,error:e}=await p();if(e||!t){window.location.href="signin.html";return}d=t,await g()}async function g(){try{const{data:t,error:e}=await u.from("profiles").select("*").eq("id",d.id).maybeSingle();if(e)throw e;t&&(document.getElementById("firstName").value=t.first_name||"",document.getElementById("lastName").value=t.last_name||"",document.getElementById("phone").value=t.phone||""),document.getElementById("email").value=d.email||""}catch(t){console.error("Error loading profile:",t),a("Failed to load profile data","error")}}async function y(t,e,o){try{const{error:s}=await u.from("profiles").update({first_name:t,last_name:e,phone:o}).eq("id",d.id);if(s)throw s;return{error:null}}catch(s){return{error:s}}}document.addEventListener("DOMContentLoaded",async()=>{await w();const t=document.getElementById("profileForm");t.addEventListener("submit",async o=>{o.preventDefault();const s=document.getElementById("firstName").value.trim(),n=document.getElementById("lastName").value.trim(),i=document.getElementById("phone").value.trim();if(!s||!n||!i){a("Please fill in all required fields","error");return}const r=t.querySelector('button[type="submit"]'),l=r.innerHTML;r.innerHTML='<i class="fas fa-spinner fa-spin"></i> Saving...',r.disabled=!0;const{error:c}=await y(s,n,i);if(r.innerHTML=l,r.disabled=!1,c){a(c.message||"Failed to update profile","error");return}a("Profile updated successfully!","success")});const e=document.getElementById("passwordForm");e.addEventListener("submit",async o=>{o.preventDefault();const s=document.getElementById("currentPassword").value,n=document.getElementById("newPassword").value,i=document.getElementById("confirmNewPassword").value;if(!s||!n||!i){a("Please fill in all password fields","error",e);return}if(n.length<8){a("New password must be at least 8 characters long","error",e);return}if(n!==i){a("New passwords do not match","error",e);return}const r=e.querySelector('button[type="submit"]'),l=r.innerHTML;r.innerHTML='<i class="fas fa-spinner fa-spin"></i> Updating...',r.disabled=!0;const{error:c}=await m(n);if(r.innerHTML=l,r.disabled=!1,c){a(c.message||"Failed to update password","error",e);return}a("Password updated successfully!","success",e),e.reset()}),document.getElementById("logoutBtn").addEventListener("click",async o=>{o.preventDefault();const{error:s}=await f();s||(window.location.href="signin.html")})});function a(t,e="info",o=null){document.querySelectorAll(".alert-message").forEach(l=>l.remove());const n=document.createElement("div");n.className=`alert-message ${e}`;const i=e==="success"?"fa-check-circle":e==="error"?"fa-exclamation-circle":"fa-info-circle";n.innerHTML=`<i class="fas ${i}"></i> ${t}`;const r=o||document.querySelector(".profile-content");r.insertBefore(n,r.firstChild),e!=="success"&&setTimeout(()=>{n.parentNode&&n.remove()},5e3)}
