import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css                  */import{c as s,o as d,d as f,a as h}from"./auth-Wv6XBAm1.js";import{logAuthEvent as w}from"./auth-logger-D64jFNGW.js";const c=30*60*1e3,g=60*1e3;let n=null,l=Date.now();function v(){u(),y(),p()}function u(){l=Date.now(),n&&clearTimeout(n),n=setTimeout(m,c)}function y(){["mousedown","keydown","scroll","touchstart","click"].forEach(e=>{document.addEventListener(e,()=>{u()},{passive:!0})})}function p(){setInterval(()=>{Date.now()-l>=c&&m()},g)}async function m(){n&&clearTimeout(n),await s(),sessionStorage.setItem("session_expired","true"),window.location.href="signin.html"}let i=null;async function T(){const{user:t,error:e}=await f();if(e||!t){window.location.href="signin.html";return}i=t,await E()}async function E(){try{const{data:t,error:e}=await h.from("profiles").select("*").eq("id",i.id).maybeSingle();if(e)throw e;if(t){const o=document.querySelector(".welcome-section h1");o&&(o.textContent=`Hi, ${t.first_name||"User"}`);const r=document.querySelectorAll(".tenant-details .detail-row span");r.length>0&&(r[0].textContent=`${t.first_name||""} ${t.last_name||""}`.trim());const a=document.querySelector(".header-actions .header-btn:last-child");a&&(a.title=`${i.email}`,a.addEventListener("click",()=>{window.location.href="profile.html"}))}}catch(t){console.error("Error loading profile:",t)}}function S(){document.querySelectorAll(".logout .nav-item, #logoutBtn, [data-logout]").forEach(e=>{e.addEventListener("click",async o=>{o.preventDefault(),i&&await w(i.id,"logout");const{error:r}=await s();r||(window.location.href="signin.html")})})}d((t,e)=>{(t==="SIGNED_OUT"||!e)&&(window.location.href="signin.html")});document.addEventListener("DOMContentLoaded",async()=>{await T(),S(),v()});
